For a discussion about this code, please see http://magpie.sytes.net/jesperhogstrom/2014/03/scriptcs-msbuild-and-taskfactories/.